<div id="multimediaView" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"
  data-folders-url="{{ url_for('admin_image_assets_folders') }}"
  data-files-template="{{ url_for('admin_image_assets_folder_files', folder_name='__FOLDER__') }}"
  data-create-url="{{ url_for('admin_create_image_folder') }}"
  data-delete-template="{{ url_for('admin_delete_image_folder', folder_name='__FOLDER__') }}"
  data-upload-url="{{ url_for('admin_upload_image_file') }}"
>
  <div class="ios-header-container mb-8">
    <div class="ios-header-backdrop">
      <div class="ios-header-content">
        <div class="ios-header-text">
          <div class="ios-header-icon">
            <i class="fas fa-photo-video"></i>
          </div>
          <div>
            <h1 class="ios-header-title">Biblioteca Multimedia</h1>
            <p class="ios-header-subtitle">Lista sincronizada de carpetas desde el servicio multimedia</p>
          </div>
        </div>
        <div class="ios-header-actions">
          <span class="ios-header-pill hidden" id="multimediaServicePill">
            <i class="fas fa-link"></i>
            <a id="multimediaServiceLink" href="#" class="hover:underline" target="_blank" rel="noopener">servicio multimedia</a>
          </span>
          <button type="button" id="openCreateFolderModal" class="ios-action-btn">
            <i class="fas fa-folder-plus"></i>
            <span>Crear directorio</span>
          </button>
          <button type="button" id="openUploadModal" class="ios-action-btn ios-action-btn-primary">
            <i class="fas fa-plus"></i>
            <span>Agregar archivo</span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <div id="multimediaError" class="ios-alert ios-alert-warning mb-6 hidden">
    <i class="fas fa-triangle-exclamation"></i>
    <span id="multimediaErrorText">No se pudo cargar la informacion del servicio multimedia.</span>
  </div>

  <div class="ios-filters-container ios-blur-bg mb-6">
    <div class="flex items-center justify-between flex-wrap gap-4">
      <div>
        <p class="text-sm text-gray-600 dark:text-gray-300">Carpetas detectadas</p>
        <p class="text-2xl font-semibold text-black dark:text-white"><span data-folder-count id="multimediaFolderCount">0</span> disponibles</p>
      </div>
      <button type="button" class="ios-header-pill" id="multimediaRefreshButton" aria-label="Actualizar listado de carpetas">
        <i class="fas fa-rotate"></i>
        <span>Actualiza para reflejar cambios</span>
      </button>
    </div>
  </div>

  <div class="ios-hardware-grid ios-folder-grid" id="multimediaFolderGrid" data-folder-grid>
    <div class="col-span-full hidden" id="multimediaEmptyState">
      <div class="ios-empty-state">
        <div class="ios-empty-icon"><i class="fas fa-folder-open"></i></div>
        <h3 class="ios-empty-title">Sin carpetas disponibles</h3>
        <p class="ios-empty-subtitle">Confirma que el servicio este en linea y vuelve a intentarlo.</p>
      </div>
    </div>
  </div>
</div>

<div id="viewFolderModal" class="ios-modal-backdrop hidden">
  <div class="ios-blur-modal-container w-full max-w-3xl">
    <div class="ios-blur-header">
      <div class="flex items-center justify-between w-full">
        <div class="flex items-center gap-3">
          <div class="w-12 h-12 bg-gradient-to-br from-sky-500 to-indigo-500 rounded-xl flex items-center justify-center shadow-lg">
            <i class="fas fa-eye text-white text-xl"></i>
          </div>
          <div>
            <h3 class="text-2xl font-bold text-white" id="viewFolderModalTitle">Carpeta seleccionada</h3>
            <p class="text-sm text-white/70">Archivos disponibles en la carpeta sincronizada</p>
          </div>
        </div>
        <button type="button" class="ios-blur-btn ios-blur-btn-secondary !p-2 !min-w-0" data-modal-close aria-label="Cerrar modal">
          <i class="fas fa-times text-lg"></i>
        </button>
      </div>
    </div>
    <div class="ios-blur-body space-y-6">
      <div id="folderFilesStatus" class="ios-folder-status hidden" aria-live="polite">
        <i id="folderFilesStatusIcon" class="fas fa-circle-info"></i>
        <span id="folderFilesStatusText"></span>
      </div>
      <p class="text-sm text-white/60 hidden" id="viewFolderModalCounter"></p>
      <div id="folderFilesGrid" class="ios-folder-files-grid"></div>
    </div>
    <div class="ios-blur-footer">
      <button type="button" class="ios-blur-btn ios-blur-btn-secondary" data-modal-close>
        <i class="fas fa-times mr-2"></i>
        Cerrar
      </button>
    </div>
  </div>
</div>

<div id="uploadFolderModal" class="ios-modal-backdrop ios-modal-compact hidden">
  <div class="ios-blur-modal-container w-full max-w-2xl">
    <div class="ios-blur-header">
      <div class="flex items-center justify-between w-full">
        <div class="flex items-center gap-3">
          <div class="w-12 h-12 bg-gradient-to-br from-emerald-500 to-lime-500 rounded-xl flex items-center justify-center shadow-lg">
            <i class="fas fa-upload text-white text-xl"></i>
          </div>
          <div>
            <h3 class="text-2xl font-bold text-white">Agregar archivo multimedia</h3>
            <p class="text-sm text-white/70">Selecciona la carpeta destino y adjunta el archivo</p>
          </div>
        </div>
        <button type="button" class="ios-blur-btn ios-blur-btn-secondary !p-2 !min-w-0" data-modal-close aria-label="Cerrar modal">
          <i class="fas fa-times text-lg"></i>
        </button>
      </div>
    </div>
    <div class="ios-blur-body space-y-6">
      <form id="folderUploadForm" class="ios-upload-form" novalidate>
        <div class="ios-upload-field">
          <label for="uploadFolderSelect" class="ios-upload-label">
            <i class="fas fa-folder-closed mr-2"></i>Carpeta destino
          </label>
          <select id="uploadFolderSelect" class="ios-blur-input" required>
            <option value="" disabled selected>Selecciona una carpeta</option>
          </select>
        </div>
        <div class="ios-upload-field">
          <label for="uploadFileName" class="ios-upload-label">
            <i class="fas fa-signature mr-2"></i>Nombre del archivo
          </label>
          <input id="uploadFileName" type="text" class="ios-blur-input" placeholder="Ej. banner_home" required>
          <p class="ios-upload-hint">Escribe manualmente el nombre final del archivo.</p>
        </div>
        <div class="ios-upload-field">
          <label for="uploadFileInput" class="ios-upload-label">
            <i class="fas fa-file-arrow-up mr-2"></i>Selecciona el archivo
          </label>
          <div class="ios-upload-dropzone">
            <input id="uploadFileInput" type="file" class="ios-upload-input" required>
            <div class="ios-upload-dropzone-content">
              <i class="fas fa-cloud-arrow-up text-white/70 text-xl"></i>
              <p class="ios-upload-hint">Arrastra y suelta o haz clic para buscar (PNG, JPG, MP4, MP3, PDF)</p>
            </div>
          </div>
          <div id="uploadPreview" class="ios-upload-preview hidden"></div>
        </div>
        <p id="uploadFeedback" class="ios-upload-feedback hidden">
          <i class="fas fa-circle-info mr-2"></i>Completa los campos para subir el archivo.
        </p>
      </form>
    </div>
    <div class="ios-blur-footer">
      <button type="button" class="ios-blur-btn ios-blur-btn-secondary" data-modal-close>
        <i class="fas fa-times mr-2"></i>
        Cancelar
      </button>
      <button type="submit" form="folderUploadForm" class="ios-blur-btn ios-blur-btn-primary" id="uploadSubmitButton">
        <i class="fas fa-cloud-upload-alt mr-2"></i>
        Guardar archivo
      </button>
    </div>
  </div>
</div>

<div id="createFolderModal" class="ios-modal-backdrop ios-modal-compact hidden">
  <div class="ios-blur-modal-container w-full max-w-lg">
    <div class="ios-blur-header">
      <div class="flex items-center justify-between w-full">
        <div class="flex items-center gap-3">
          <div class="w-12 h-12 bg-gradient-to-br from-indigo-500 to-purple-500 rounded-xl flex items-center justify-center shadow-lg">
            <i class="fas fa-folder-plus text-white text-xl"></i>
          </div>
          <div>
            <h3 class="text-2xl font-bold text-white">Crear nuevo directorio</h3>
            <p class="text-sm text-white/70">Asigna un nombre y un identificador interno</p>
          </div>
        </div>
        <button type="button" class="ios-blur-btn ios-blur-btn-secondary !p-2 !min-w-0" data-modal-close aria-label="Cerrar modal">
          <i class="fas fa-times text-lg"></i>
        </button>
      </div>
    </div>
    <div class="ios-blur-body space-y-6">
      <form id="folderCreateForm" class="ios-upload-form" novalidate>
        <div class="ios-upload-field">
          <label for="createFolderDisplay" class="ios-upload-label">
            <i class="fas fa-font mr-2"></i>Nombre visible
          </label>
          <input id="createFolderDisplay" type="text" class="ios-blur-input" placeholder="Ej. Campanas Otono" required>
          <p class="ios-upload-hint">Se enviara como "name" al servicio externo.</p>
        </div>
        <p id="createFolderFeedback" class="ios-upload-feedback hidden">
          <i class="fas fa-circle-info mr-2"></i>Completa el nombre del directorio.
        </p>
      </form>
    </div>
    <div class="ios-blur-footer">
      <button type="button" class="ios-blur-btn ios-blur-btn-secondary" data-modal-close>
        <i class="fas fa-times mr-2"></i>
        Cancelar
      </button>
      <button type="submit" form="folderCreateForm" class="ios-blur-btn ios-blur-btn-primary" id="createFolderSubmitButton">
        <i class="fas fa-check mr-2"></i>
        Crear directorio
      </button>
    </div>
  </div>
</div>

<div id="deleteFolderModal" class="ios-modal-backdrop hidden">
  <div class="ios-blur-modal-container w-full max-w-md">
    <div class="ios-blur-header">
      <div class="flex items-center justify-between w-full">
        <div class="flex items-center gap-3">
          <div class="w-12 h-12 bg-gradient-to-br from-rose-500 to-red-500 rounded-xl flex items-center justify-center shadow-lg">
            <i class="fas fa-trash text-white text-xl"></i>
          </div>
          <div>
            <h3 class="text-2xl font-bold text-white" id="deleteFolderTitle">Eliminar directorio</h3>
            <p class="text-sm text-white/70">Esta accion removira el directorio del servicio externo</p>
          </div>
        </div>
        <button type="button" class="ios-blur-btn ios-blur-btn-secondary !p-2 !min-w-0" data-modal-close aria-label="Cerrar modal">
          <i class="fas fa-times text-lg"></i>
        </button>
      </div>
    </div>
    <div class="ios-blur-body space-y-5">
      <div class="ios-delete-summary">
        <p class="ios-upload-label flex items-center gap-2">
          <i class="fas fa-folder-open text-white/70"></i>
          <span id="deleteFolderName">sin-nombre</span>
        </p>
        <p class="ios-upload-hint">Confirma que deseas eliminar este directorio y su contenido en el servicio multimedia.</p>
      </div>
      <p id="deleteFolderFeedback" class="ios-upload-feedback hidden">
        <i class="fas fa-circle-info mr-2"></i>Confirma la eliminacion del directorio seleccionado.
      </p>
    </div>
    <div class="ios-blur-footer">
      <button type="button" class="ios-blur-btn ios-blur-btn-secondary" data-modal-close>
        <i class="fas fa-times mr-2"></i>
        Cancelar
      </button>
      <button type="button" class="ios-blur-btn ios-blur-btn-danger" id="confirmDeleteFolderButton" data-delete-url="">
        <i class="fas fa-trash mr-2"></i>
        Eliminar
      </button>
    </div>
  </div>
</div>

<div id="multimediaUpdateModal" class="ios-modal-backdrop hidden">
  <div class="ios-blur-modal-container max-w-md" id="multimediaUpdateContainer">
    <div class="ios-blur-header text-center">
      <div class="client-update-icon mx-auto mb-4" id="multimediaUpdateIcon">
        <i class="fas fa-check-circle text-4xl text-emerald-400" id="multimediaUpdateIconFa"></i>
      </div>
      <h3 class="text-2xl font-bold text-white mb-2" id="multimediaUpdateTitle">Operacion Exitosa</h3>
    </div>
    <div class="ios-blur-body text-center">
      <p class="text-white/80 text-lg mb-6" id="multimediaUpdateMessage">Accion completada correctamente.</p>
      <button type="button" class="ios-blur-btn ios-blur-btn-primary mx-auto" data-modal-close>
        <i class="fas fa-check mr-2"></i>
        <span class="text-sm font-medium">Aceptar</span>
      </button>
    </div>
  </div>
</div>
